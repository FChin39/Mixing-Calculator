"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function getModuleResource(module) {
    var _a;
    if (!module) {
        return '';
    }
    // 跳过 css 模块
    if (module.constructor.name === 'CssModule') {
        return '';
    }
    // TODO: 针对不同类型的 module 做处理
    return module.resource || ((_a = module.rootModule) === null || _a === void 0 ? void 0 : _a.resource);
}
function getModule(module, modules) {
    const resource = getModuleResource(module);
    if (!resource) {
        return [];
    }
    return Array.from(new Set([
        resource,
        ...module.dependencies.reduce((acc, d) => {
            const newModules = [...acc, ...modules];
            const module = d.module || d.originModule;
            const resource = getModuleResource(module);
            if (!resource) {
                return acc;
            }
            if (newModules.includes(resource)) {
                return acc;
            }
            return [...acc, resource, ...getModule(module, [...newModules, resource])];
        }, []),
    ]));
}
function getModules(chunk) {
    const modules = Array.from(chunk._modules)
        .reduce((acc, cur) => [...acc, ...getModule(cur, acc)], [])
        .filter(Boolean)
        .sort();
    return Array.from(new Set(modules));
}
exports.default = getModules;
